<!DOCTYPE html>
<html>
<head>
<title>Chrome hover-url ellipsizing bug repo</title>
</head>
<body>
<style>
.width-readout {
  width: auto;
  margin-left: auto;
  float: right;
}
.width-display {
  box-sizing: content-box;
  margin-left: 4rem;
  font-size: 24px;
  max-width: 100vw;
}
.width-value {
  font-size: 24px;
  font-face: monospace;
  font-weight: bold;
}
form {
  margin: 0 auto;
  width: auto;
}
.arrows {
  box-sizing: border-box;
  min-width: 100%;
  width: 100%;
  height: auto;
}
</style>
<script>
let timers = new Map();
let win_width;
function update_size(event, form) {
  const disabler = form.querySelector("input.onoff");
  win_width = window.innerWidth;
  if (!disabler.checked) {
    const value = form.querySelector("input.width-value");
    value.value = win_width;
  }
};
function set_watcher(form) {
  const disabler = form.querySelector("input.onoff");
  const watcher = addEventListener("resize", (event) => { update_size(event, form); });
  timers[form] = watcher;
  disabler.addEventListener("change", 
    (event) => { if (!event?.target?.checked) update_size({}, form); });
};
addEventListener("load", () => {
  const forms = document.querySelectorAll(".width-readout");
  for (const form of forms) {
    set_watcher(form);
    update_size({}, form);
  }
});
</script>
<h1>Reproducing failed url-hover expansion in desktop Chrome</h1>

<h2>What you'll need to test this bug</h2>
<ol>
<li>A desktop version of Chrome, for any OS.</li>
<li>An input device (mouse, trackpad, etc.) controlling a pointer which can be hovered over links without clicking them. (No touchscreen navigation.)</li>
<li>Chrome running in a resizable window where you can control the exact width of the browser. (No fullscreen.)
</ol>

<h2>How to test</h2>

<h3>Link 1: FOUT</h3>
<p>Hover over this link:
<span style="font-size:24px;font-weight:bold;">
<a href="http://www.paulirish.com/2009/fighting-the-font-face-fout/">Fighting the font-face FOUT</a>
</span></p>
<form id="form1" class="width-readout">
<p>Page width: 
<input type="text" class="width-value" minlength="1" maxlength="4" size="5" id="value1"></input> px</p>
<p><input id="onoff1" class="onoff" type="checkbox" unchecked>Lock width</input></p>
</form>
<div class-"width-display">
<svg class="arrows" id="arrows1" width="1920.1016" height="107.0318" viewBox="0 0 1920.1016 107.0318" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
<defs id="defs1"> 
  <marker style="overflow:visible" id="marker2" refX="0" refY="0" orient="auto-start-reverse" markerWidth="1" markerHeight="1" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid">
    <path transform="scale(0.7)" d="m -0.21114562,-4.1055728 6.42229122,3.21114561 a 1,1 90 0 1 0,1.78885438 L -0.21114562,4.1055728 A 1.236068,1.236068 31.717474 0 1 -2,3 v -6 a 1.236068,1.236068 148.28253 0 1 1.78885438,-1.1055728 z" style="fill:context-stroke;fill-rule:evenodd;stroke:none" id="path2" />
  </marker>
  <marker style="overflow:visible" id="RoundedArrow" refX="0" refY="0" orient="auto-start-reverse" markerWidth="1" markerHeight="1" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid">
    <path transform="scale(0.7)" d="m -0.21114562,-4.1055728 6.42229122,3.21114561 a 1,1 90 0 1 0,1.78885438 L -0.21114562,4.1055728 A 1.236068,1.236068 31.717474 0 1 -2,3 v -6 a 1.236068,1.236068 148.28253 0 1 1.78885438,-1.1055728 z" style="fill:context-stroke;fill-rule:evenodd;stroke:none" id="path8" />
  </marker>
</defs>
<g id="layer1" transform="translate(-0.9510019,-0.99999986)">
  <path style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:18.0477;stroke-linecap:butt;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#RoundedArrow);marker-end:url(#marker2)" d="M 86.402397,54.515901 H 1835.6012" id="path1" />
</g>
</svg>
</div>
<p>That link points to this URL: <code>http://www.paulirish.com/2009/fighting-the-font-face-fout/</code>. When hovered over with the pointer, Chrome will display a preview of the link target at the bottom of the browser window.</p>
<p>Depending on the width of the window, any of these texts may be displayed on hover:</p>
<ul style="list-style-type: none">
<li><code>paulirish.com/.../fighting-the-f...</code></li>
<li><code>paulirish.com/.../fighting-the-font-face-f...</code></li>
<li><code>paulirish.com/2009/fighting-the-font-face-f...</code></li>
<li>Or some other variation.</li>
</ul>
<p>After a brief delay, the hover display will change to the full URL, minus the <code>http://</code> at the start.</p>

<p>Now, resize the browser window so that the hover preview text is <b><i>exactly</i></b> this (including the "<code>www.</code>" at the start):</p>
<ul style="list-style-type: none">
<li><code>www.paulirish.com/2009/fighting-the-font-face-f...</code></li>
</ul>
<p>The exact width is different for every OS (and possibly every desktop theme), but in every case there is a precise width which causes the URL to ellipsize to that exact text.</p>
<p>When the URL has been shortened to <b><i>exactly</i></b> <code>www.paulirish.com/2009/fighting-the-font-face-f...</code>, the expansion to the full URL (which normally takes only a fraction of a second) will never occur.</p>
<p>The width display over the arrows is tracking <code>window.innerWidth</code>. When you find a width that triggers the bug, "Lock width" will preserve that value. My values: Fedora Linux 42 with Chrome 137.0.7151.103, <code>1007 px</code>. Windows 10 with Chrome 137.0.7151.120, <code>876 px</code>.</p>


<h3>Link 2: Specifying Paint</h3>
<p>Hover over this link:
<span style="font-size:24px;font-weight:bold;">
<a href="https://svgwg.org/svg2-draft/painting.html#SpecifyingPaint">Specifying Paint</a>
</span></p>
<form id="form2" class="width-readout">
<p>Page width: 
<input type="text" class="width-value" minlength="1" maxlength="4" size="5" id="value2"></input> px</p>
<p><input id="onoff2" class="onoff" type="checkbox" unchecked>Lock width</input></p>
</form>
<div class-"width-display">
<svg class="arrows" id="arrows2" width="1920.1016" height="107.0318" viewBox="0 0 1920.1016 107.0318" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
<defs id="defs1"> 
  <marker style="overflow:visible" id="marker2" refX="0" refY="0" orient="auto-start-reverse" markerWidth="1" markerHeight="1" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid">
    <path transform="scale(0.7)" d="m -0.21114562,-4.1055728 6.42229122,3.21114561 a 1,1 90 0 1 0,1.78885438 L -0.21114562,4.1055728 A 1.236068,1.236068 31.717474 0 1 -2,3 v -6 a 1.236068,1.236068 148.28253 0 1 1.78885438,-1.1055728 z" style="fill:context-stroke;fill-rule:evenodd;stroke:none" id="path2" />
  </marker>
  <marker style="overflow:visible" id="RoundedArrow" refX="0" refY="0" orient="auto-start-reverse" markerWidth="1" markerHeight="1" viewBox="0 0 1 1" preserveAspectRatio="xMidYMid">
    <path transform="scale(0.7)" d="m -0.21114562,-4.1055728 6.42229122,3.21114561 a 1,1 90 0 1 0,1.78885438 L -0.21114562,4.1055728 A 1.236068,1.236068 31.717474 0 1 -2,3 v -6 a 1.236068,1.236068 148.28253 0 1 1.78885438,-1.1055728 z" style="fill:context-stroke;fill-rule:evenodd;stroke:none" id="path8" />
  </marker>
</defs>
<g id="layer1" transform="translate(-0.9510019,-0.99999986)">
  <path style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:18.0477;stroke-linecap:butt;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#RoundedArrow);marker-end:url(#marker2)" d="M 86.402397,54.515901 H 1835.6012" id="path1" />
</g>
</svg>
</div>
<p>That link points to this URL: <code>https://svgwg.org/svg2-draft/painting.html#SpecifyingPaint</code>.</p>
<p>Depending on the width of the window, any of these texts may be displayed on hover:</p>
<ul style="list-style-type: none">
<li><code>svgwg.org/.../painting.html</code></li>
<li><code>svgwg.org/svg2-draft/painting.h...</code></li>
<li><code>svgwg.org/svg2-draft/painting.html</code></li>
<li><code>https://svgwg.org/svg2-draft/painting.ht...</code></li>
<li><code>https://svgwg.org/svg2-draft/painting.html#...</code></li>
<li>Or some other variation.</li>
</ul>
<p>After a brief delay, the hover display will change to the full URL, including the <code>https://</code>.</p>

<p>Resize the browser window so that the hover preview text is some variation on the following. The <code>https://</code> should be visible at the start:</p>
<ul style="list-style-type: none">
<li><code>https://svgwg.org/svg2-draft/painting.html#SpecifyingP...</code></li>
</ul>
<p>Again, when the URL is shortened in that manner, the expansion to the full URL will never occur. My values: Fedora Linux 42 with Chrome 137.0.7151.103, <code>1126 px</code>. Windows 10 with Chrome 137.0.7151.120, <code>951 px</code>.</p>
</body>
</html>

